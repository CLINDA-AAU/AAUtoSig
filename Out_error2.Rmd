---
title: "Out error 2"
author: "Ida Egendal"
date: "20 12 2021"
output: html_document
---

```{r, include=F}
library(reticulate)
matplotlib <- import("matplotlib", convert = TRUE)
matplotlib$use("Agg")
```


## Load packages
Firstly, we load the necessary packages for the code to run

```{python}
import torch
import torch.nn.functional as F

import matplotlib.pyplot as plt
import pandas as pd
import numpy as np
import sklearn
from sklearn.decomposition import NMF


import copy

#because plots broke the kernel
import os
os.environ["KMP_DUPLICATE_LIB_OK"]="TRUE"
```

## Split data
Firstly we write a method to split the mutational profile matrix into a training and validation set.

```{python}
def split_data(data, frac):
  x_train = data.sample(frac=frac)
  x_val = data.drop(x_train.index)
  return x_train, x_val
```

## Load data
The anaylysis will be performed on Reddys 2017 1001 DLBCL data. Here it is loaded locally from my home directory. But the full mutational profile matrix can also be found in in Q:\AUH-HAEM-FORSK-MutSigDLBCL222\external_data\DLBCL_1001.

```{python}
mc = pd.read_csv(r'home/bjyw/article_1/DLBCL_mut_matrix.tsv', sep=' ', index_col=0).transpose()
```



## Classic NMF

